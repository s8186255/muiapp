/*!
 * =====================================================
 * TS v1.0.0 ()
 * =====================================================
 */
!function(a){a.Scroll.prototype.__setTranslate=a.Scroll.prototype.setTranslate,a.Scroll.prototype.setTranslate=function(){var b=this;b.__setTranslate.apply(b,arguments),a.trigger(b.scroller,"scroll",b)},a.dom=function(b){return"string"!=typeof b?b instanceof Array||b[0]&&b.length?[].slice.call(b):[b]:(a.__create_dom_div__||(a.__create_dom_div__=document.createElement("div")),a.__create_dom_div__.innerHTML=b,[].slice.call(a.__create_dom_div__.childNodes))};var b=0,c=a.ListPicker=a.Class.extend({init:function(c,d){var e=this;if(!c)throw"构造 ListPicker 时找不到元素";e.box=c,e.box.listpickerId||(e.listpickerId=e.box.listpickerId="listpicker-"+ ++b,e.box.setAttribute("data-listpicker-id",e.box.listpickerId),d=d||{},d.fiexdDur=d.fiexdDur||150,d.highlightStyle=d.highlightStyle||"color: green;",(null===d.enabledH5||"undefined"==typeof d.enabledH5)&&(d.enabledH5=a.os.ios),(null===d.enabled3d||"undefined"==typeof d.enabled3d)&&(d.enabled3d=!0),d.enabled3d=!1,e.options=d,e._create(),e._handleShim(),e._bindEvent(),e._applyToBox(),e._handleHighlight())},_create:function(){var b=this;b.boxInner=a(".mui-listpicker-inner",b.box)[0],b.boxHeight=b.box.offsetHeight,b.list=a("ul",b.boxInner)[0];var c=a("li",b.list)[0];b.itemHeight=0,c?b.itemHeight=c.offsetHeight:(b.list.innerHTML="<li>...</li>",c=a("li",b.list)[0],b.itemHeight=c.offsetHeight,b.list.innerHTML=""),b.list.style.paddingTop=b.list.style.paddingBottom=b.boxHeight/2-b.itemHeight/2+"px",b.rule=a.dom('<div class="mui-listpicker-rule"> </div>')[0],b.rule.style.height=b.itemHeight+"px",b.rule.style.marginTop=-(b.itemHeight/2)+"px",b.box.appendChild(b.rule),b.middle=b.boxInner.offsetHeight/2,b.options.enabled3d&&b.box.classList.add("three-dimensional")},_handleShim:function(){var b=this;b.options.enabledH5?(b.options.fiexdDur*=2,b._scrollerApi=a(b.boxInner).scroll(),b.setScrollTop=function(a,c,d){b._scrollerApi.scrollTo(0,-a,c)},b.getScrollTop=function(){var a=this;return a._scrollerApi.lastY>0?0:Math.abs(a._scrollerApi.lastY)}):(b.boxInner.addEventListener("scroll",function(c){b.disabledScroll||(b.isScrolling=!0,b.scrollTimer&&clearTimeout(b.scrollTimer),b.scrollTimer=setTimeout(function(){b.isScrolling=!1,b.isTouchDown&&a.os.ios||a.trigger(b.boxInner,"scrollend")},100))},!1),b.aniScrollTop=function(a,c,d){b.disabledScroll=!0;var e=c>0?c/10:1,f=(a-b.boxInner.scrollTop)/e;b._lastScrollTop=b.boxInner.scrollTop,b._aniScrollTop(a,0,e,f,d)},b._aniScrollTop=function(a,c,d,e,f){b.boxInner.scrollTop=b._lastScrollTop+e*c,d>c?setTimeout(function(){b._aniScrollTop(a,++c,d,e)},10):(b.disabledScroll=!1,f&&f())},b.setScrollTop=function(a,c,d){b.aniScrollTop(a,c)},b.getScrollTop=function(){var a=this;return a.boxInner.scrollTop},a.os.ios&&(b.boxInner.addEventListener("touchstart",function(a){var b=this;b.isTouchDown=!0},!1),b.boxInner.addEventListener("touchend",function(c){b.isTouchDown=!1,b.isScrolling||setTimeout(function(){a.trigger(b.boxInner,"scrollend")},0)},!1)))},_handleHighlight:function(){var b=this,c=b.getScrollTop(),d=parseInt((c/b.itemHeight).toFixed(0)),e=[].slice.call(a("li",b.list));e.forEach(function(c){var f=e.indexOf(c);if(f==d?(c.classList.add(a.className("listpicker-item-selected")),c.classList.remove(a.className("listpicker-item-before")),c.classList.remove(a.className("listpicker-item-after"))):(c.classList.add(a.className("listpicker-item-"+(d>f?"before":"after"))),c.classList.remove(a.className("listpicker-item-selected"))),b.options.enabled3d){var g=b.middle-(c.offsetTop-b.getScrollTop()+b.itemHeight/2)+1,h=g/b.itemHeight,i=18*h;i>180&&(i=180),-180>i&&(i=-180),c.style.webkitTransform="rotateX("+i+"deg)"}})},_triggerChange:function(){var b=this;a.trigger(b.box,"change",{index:b.getSelectedIndex(),value:b.getSelectedValue(),text:b.getSelectedText(),item:b.getSelectedItem(),element:b.getSelectedElement()})},_scrollEndHandle:function(){var a=this,b=a.getScrollTop(),c=(b/a.itemHeight).toFixed(0);a.disabledScrollEnd=!0,a.setSelectedIndex(c),a._triggerChange(),a._handleHighlight(),setTimeout(function(){a.disabledScrollEnd=!1,a._handleHighlight()},a.options.fiexdDur)},_bindEvent:function(){var b=this;b.boxInner.addEventListener("scroll",function(a){b._handleHighlight(a)},!1),b.disabledScrollEnd=!1,b.boxInner.addEventListener("scrollend",function(a){b.disabledScrollEnd||(b.disabledScrollEnd=!0,b._scrollEndHandle())},!1),a(b.boxInner).on("tap","li",function(c){var d=this,e=[].slice.call(a("li",b.list));for(var f in e){var g=e[f];if(g==d)return void b.setSelectedIndex(f)}})},getSelectedIndex:function(){var a=this;return(a.getScrollTop()/a.itemHeight).toFixed(0)},setSelectedIndex:function(a,b){var c=this;a=a||0,c.setScrollTop(c.itemHeight*a,b?0:c.options.fiexdDur)},getSelectedElement:function(){var b=this,c=b.getSelectedIndex();return a("li",b.list)[c]},getSelectedItem:function(){var a=this,b=a.getSelectedElement();if(!b)return null;var c=b.getAttribute("data-item");return c?JSON.parse(c):{text:b.innerText,value:b.getAttribute("data-value")}},setItems:function(a){var b=this,c=[];for(index in a){var d=a[index]||{text:"null",value:"null"+index},e=JSON.stringify(d);c.push("<li data-value='"+d.value+"' data-item='"+e+"'>"+d.text+"</li>")}b.list.innerHTML=c.join(""),b._scrollerApi&&b._scrollerApi.refresh&&b._scrollerApi.refresh(),b._handleHighlight(),b._triggerChange()},getItems:function(){var b=this,c=[],d=a("li",b.list);for(index in d){var e=d[index],f=e.getAttribute("data-item");c.push(f?JSON.parse(f):{text:e.innerText,value:e.getAttribute("data-value")})}return c},getSelectedValue:function(){var a=this,b=a.getSelectedItem();return b?b.value:null},getSelectedText:function(){var a=this,b=a.getSelectedItem();return b?b.text:null},setSelectedValue:function(b,c){var d=this,e=a("li",d.list);for(index in e){var f=e[index];if(f&&f.getAttribute&&f.getAttribute("data-value")==b)return void d.setSelectedIndex(index,c)}},_applyToBox:function(){var a=this,b=["getSelectedIndex","setSelectedIndex","getSelectedElement","getSelectedItem","setItems","getItems","getSelectedValue","getSelectedText","setSelectedValue"],c=function(b){"function"==typeof a[b]?a.box[b]=function(){return a[b].apply(a,arguments)}:a.box[b]=a[b]};for(var d in b){var e=b[d];c(e)}}});a.fn.listpicker=function(a){return this.each(function(b,d){if(a)new c(d,a);else{var e=d.getAttribute("data-listpicker-options"),f=e?JSON.parse(e):{};f.enabledH5=d.getAttribute("data-listpicker-enabledh5")||f.enabledH5,f.enabled3d=d.getAttribute("data-listpicker-enabled3d")||f.enabled3d,f.fixedDur=d.getAttribute("data-listpicker-fixddur")||f.fixedDur,new c(d,f)}}),this},a.ready(function(){a(".mui-listpicker").listpicker()})}(mui),function(a,b){var c='<div class="mui-dtpicker" data-type="datetime">		<div class="mui-dtpicker-header">			<button data-id="btn-cancel" class="mui-btn">取消</button>			<button data-id="btn-ok" class="mui-btn mui-btn-blue">确定</button>		</div>		<div class="mui-dtpicker-title"><h5 data-id="title-y">年</h5><h5 data-id="title-m">月</h5><h5 data-id="title-d">日</h5><h5 data-id="title-h">时</h5><h5 data-id="title-i">分</h5></div>		<div class="mui-dtpicker-body">			<div data-id="picker-y" class="mui-listpicker">				<div class="mui-listpicker-inner">					<ul>					</ul>				</div>			</div>			<div data-id="picker-m" class="mui-listpicker">				<div class="mui-listpicker-inner">					<ul>					</ul>				</div>			</div>			<div data-id="picker-d" class="mui-listpicker">				<div class="mui-listpicker-inner">					<ul>					</ul>				</div>			</div>			<div data-id="picker-h" class="mui-listpicker">				<div class="mui-listpicker-inner">					<ul>					</ul>				</div>			</div>			<div data-id="picker-i" class="mui-listpicker">				<div class="mui-listpicker-inner">					<ul>					</ul>				</div>			</div>		</div>	</div>';a.DtPicker=a.Class.extend({init:function(d){var e=this,f=a.dom(c)[0];b.body.appendChild(f),a('[data-id*="picker"]',f).listpicker();var g=e.ui={picker:f,mask:a.createMask(),ok:a('[data-id="btn-ok"]',f)[0],cancel:a('[data-id="btn-cancel"]',f)[0],y:a('[data-id="picker-y"]',f)[0],m:a('[data-id="picker-m"]',f)[0],d:a('[data-id="picker-d"]',f)[0],h:a('[data-id="picker-h"]',f)[0],i:a('[data-id="picker-i"]',f)[0],labels:a('[data-id*="title-"]',f)};g.cancel.addEventListener("tap",function(){e.hide()},!1),g.ok.addEventListener("tap",function(){var a=e.callback(e.getSelected());a!==!1&&e.hide()},!1),g.y.addEventListener("change",function(){e._createDay()},!1),g.m.addEventListener("change",function(){e._createDay()},!1),g.mask[0].addEventListener("tap",function(){e.hide()},!1),e._create(d)},getSelected:function(){var a=this,b=a.ui,c=a.options.type,d={type:c,y:b.y.getSelectedItem(),m:b.m.getSelectedItem(),d:b.d.getSelectedItem(),h:b.h.getSelectedItem(),i:b.i.getSelectedItem(),toString:function(){return this.value}};switch(c){case"datetime":d.value=d.y.value+"-"+d.m.value+"-"+d.d.value+" "+d.h.value+":"+d.i.value,d.text=d.y.text+"-"+d.m.text+"-"+d.d.text+" "+d.h.text+":"+d.i.text;break;case"date":d.value=d.y.value+"-"+d.m.value+"-"+d.d.value,d.text=d.y.text+"-"+d.m.text+"-"+d.d.text;break;case"time":d.value=d.h.value+":"+d.i.value,d.text=d.h.text+":"+d.i.text;break;case"month":d.value=d.y.value+"-"+d.m.value,d.text=d.y.text+"-"+d.m.text;break;case"hour":d.value=d.y.value+"-"+d.m.value+"-"+d.d.value+" "+d.h.value,d.text=d.y.text+"-"+d.m.text+"-"+d.d.text+" "+d.h.text}return d},setSelectedValue:function(a){var b=this,c=b.ui,d=b._parseValue(a);c.y.setSelectedValue(d.y,!0),c.m.setSelectedValue(d.m,!0),c.d.setSelectedValue(d.d,!0),c.h.setSelectedValue(d.h,!0),c.i.setSelectedValue(d.i,!0)},isLeapYear:function(a){return a%4==0&&a%100!=0||a%400==0},_inArray:function(a,b){for(var c in a){var d=a[c];if(d===b)return!0}return!1},getDayNum:function(a,b){var c=this;return c._inArray([1,3,5,7,8,10,12],b)?31:c._inArray([4,6,9,11],b)?30:c.isLeapYear(a)?29:28},_fill:function(a){return a=a.toString(),a.length<2&&(a=0+a),a},_createYear:function(a){var b=this,c=b.options,d=b.ui,e=[];if(c.customData.y)e=c.customData.y;else for(var f=c.beginYear,g=c.endYear,h=f;g>=h;h++)e.push({text:h+"",value:h});d.y.setItems(e)},_createMonth:function(a){var b=this,c=b.options,d=b.ui,e=[];if(c.customData.m)e=c.customData.m;else for(var f=1;12>=f;f++){var g=b._fill(f);e.push({text:g,value:g})}d.m.setItems(e)},_createDay:function(a){var b=this,c=b.options,d=b.ui,e=[];if(c.customData.d)e=c.customData.d;else for(var f=b.getDayNum(parseInt(d.y.getSelectedValue()),parseInt(d.m.getSelectedValue())),g=1;f>=g;g++){var h=b._fill(g);e.push({text:h,value:h})}d.d.setItems(e),a=a||d.d.getSelectedValue()},_createHours:function(a){var b=this,c=b.options,d=b.ui,e=[];if(c.customData.h)e=c.customData.h;else for(var f=0;23>=f;f++){var g=b._fill(f);e.push({text:g,value:g})}d.h.setItems(e)},_createMinutes:function(a){var b=this,c=b.options,d=b.ui,e=[];if(c.customData.i)e=c.customData.i;else for(var f=0;59>=f;f++){var g=b._fill(f);e.push({text:g,value:g})}d.i.setItems(e)},_setLabels:function(){var a=this,b=a.options,c=a.ui;c.labels.each(function(a,c){c.innerText=b.labels[a]})},_setButtons:function(){var a=this,b=a.options,c=a.ui;c.cancel.innerText=b.buttons[0],c.ok.innerText=b.buttons[1]},_parseValue:function(a){var b={};if(a){var c=a.replace(":","-").replace(" ","-").split("-");b.y=c[0],b.m=c[1],b.d=c[2],b.h=c[3],b.i=c[4]}else{var d=new Date;b.y=d.getFullYear(),b.m=d.getMonth()+1,b.d=d.getDate(),b.h=d.getHours(),b.i=d.getMinutes()}return b},_create:function(a){var b=this;a=a||{},a.labels=a.labels||["年","月","日","时","分"],a.buttons=a.buttons||["取消","确定"],a.type=a.type||"datetime",a.customData=a.customData||{},b.options=a;var c=new Date;a.beginYear=a.beginYear||c.getFullYear()-5,a.endYear=a.endYear||c.getFullYear()+5;var d=b.ui;b._setLabels(),b._setButtons(),d.picker.setAttribute("data-type",a.type),b._createYear(),b._createMonth(),b._createDay(),b._createHours(),b._createMinutes(),b.setSelectedValue(a.value)},show:function(c){var d=this,e=d.ui;d.callback=c||a.noop,e.mask.show(),b.body.classList.add(a.className("dtpicker-active-for-page")),e.picker.classList.add(a.className("active"))},hide:function(){var c=this,d=c.ui;d.picker.classList.remove(a.className("active")),d.mask.close(),b.body.classList.remove(a.className("dtpicker-active-for-page"))}})}(mui,document);