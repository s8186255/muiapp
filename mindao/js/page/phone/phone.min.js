/*!
 * =====================================================
 * TS v1.0.0 ()
 * =====================================================
 */
!function(a,b){b.PhonePage=b.UserPage.extend({params:{},initConfig:function(){this._super(),b.backUrl="../login/login.html",document.location.search&&(this.params=b.parseParams(document.location.search))},initPage:function(){"bind"!==this.params.type?document.getElementById("ts_title").innerText="更换手机号":document.getElementById("ts_title").innerText="绑定手机号"},initEvent:function(){var a=this;document.getElementById("get_sms").addEventListener("tap",function(){var c=this;if(!c.busying){var d=a.checkPhone();d&&(c.busying=!0,c.innerText="正在发送中",b.Api.get_sms(3,d,b.User.get_user_id(),function(b){a.countSms(c)},function(){b.error("获取验证码失败，请重试"),c.innerText="获取验证码"}))}}),document.getElementById("confirm").addEventListener("tap",function(){var c=a.checkPhone(),d=a.checkSms();return c&&d?b.showWaiting():b.closeWaiting(),!1})},countSms:function(a){var b=60,c=window.setInterval(function(){a.innerText=--b+"秒后重发",0>=b&&(window.clearInterval(c),a.busying=!1,a.innerText="获取验证码")},1e3)},checkPhone:function(){var a=document.getElementById("phone"),c=a.value;return/^1[3|4|5|8|7][0-9]\d{4,8}$/.test(c)?c:(a.value="",b.alert("您输入的手机号码不符合格式，请重新输入！"),setTimeout(function(){a.focus()},20),!1)},checkSms:function(){var a=document.getElementById("sms"),c=a.value;return/[0-9]{6}$/.test(c)?c:(a.value="",b.alert("您输入的验证码不符合格式，请重新输入！"),setTimeout(function(){a.focus()},20),!1)}})}(mui,TS);