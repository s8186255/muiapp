/*!
 * =====================================================
 * TS v1.0.0 ()
 * =====================================================
 */
!function(a,b){b.SitesPage=a.Class.extend({init:function(){this.initConfig(),this.initPage(),this.initEvent()},initConfig:function(){var a=this;document.location.search&&(a.params=b.parseParams(document.location.search),a.params.from&&(b.backUrl="../my/my.html"))},initPage:function(){this.initSite(function(){b.template("sites","sites/sites",{siteData:b.Site.sites}),a("#scroll").scroll()})},refresh:function(){this.initPage()},initSite:function(c){b.User.isLogin()?(b.showWaiting(),b.Api.get_site_list(b.User.get_user_id(),function(d){a.isArray(d.data)&&b.Site.init(d.data),c&&c(),b.closeWaiting()},function(){c&&c(),b.closeWaiting()})):c&&c()},initEvent:function(){var c=this;a("#sites").on("tap",".ts-delete",function(){var a=this.parentNode.parentNode,c=this.getAttribute("data-id");b.confirm("确定要删除该地址?",function(d){d&&(b.showWaiting(),b.Api.delete_site(b.User.get_user_id(),c,function(){b.closeWaiting(),a.parentNode.removeChild(a),c==b.Site.get_site_id()&&b.Site.clear()}))})}),a("#sites").on("tap","#site_list li",function(){b.showWaiting();var d=this.getAttribute("data-id");b.Site.set_site(d),b.Location.set_location({address:b.Site.sites[d].address},function(){c.changeSite(),b.closeWaiting(),a.back()})})},changeSite:function(){}})}(mui,TS),function(a,b){a.os.plus&&(b.SitesPage=b.SitesPage.extend(a.extend(b.AppObject,{changeSite:function(){this._super(),a.fire(plus.webview.getLaunchWebview(),"address"),a.fire(plus.webview.getWebviewById("nav_home"),"address")},init5plusEvent:function(){var a=this;document.addEventListener("sites",function(b){a.refresh()})}})))}(mui,TS);