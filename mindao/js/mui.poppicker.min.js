/*!
 * =====================================================
 * TS v1.0.0 ()
 * =====================================================
 */
!function(a){a.Scroll.prototype.__setTranslate=a.Scroll.prototype.setTranslate,a.Scroll.prototype.setTranslate=function(){var b=this;b.__setTranslate.apply(b,arguments),a.trigger(b.scroller,"scroll",b)},a.dom=function(b){return"string"!=typeof b?b instanceof Array||b[0]&&b.length?[].slice.call(b):[b]:(a.__create_dom_div__||(a.__create_dom_div__=document.createElement("div")),a.__create_dom_div__.innerHTML=b,[].slice.call(a.__create_dom_div__.childNodes))};var b=0,c=a.ListPicker=a.Class.extend({init:function(c,d){var e=this;if(!c)throw"构造 ListPicker 时找不到元素";e.box=c,e.box.listpickerId||(e.listpickerId=e.box.listpickerId="listpicker-"+ ++b,e.box.setAttribute("data-listpicker-id",e.box.listpickerId),d=d||{},d.fiexdDur=d.fiexdDur||150,d.highlightStyle=d.highlightStyle||"color: green;",(null===d.enabledH5||"undefined"==typeof d.enabledH5)&&(d.enabledH5=a.os.ios),(null===d.enabled3d||"undefined"==typeof d.enabled3d)&&(d.enabled3d=!0),d.enabled3d=!1,e.options=d,e._create(),e._handleShim(),e._bindEvent(),e._applyToBox(),e._handleHighlight())},_create:function(){var b=this;b.boxInner=a(".mui-listpicker-inner",b.box)[0],b.boxHeight=b.box.offsetHeight,b.list=a("ul",b.boxInner)[0];var c=a("li",b.list)[0];b.itemHeight=0,c?b.itemHeight=c.offsetHeight:(b.list.innerHTML="<li>...</li>",c=a("li",b.list)[0],b.itemHeight=c.offsetHeight,b.list.innerHTML=""),b.list.style.paddingTop=b.list.style.paddingBottom=b.boxHeight/2-b.itemHeight/2+"px",b.rule=a.dom('<div class="mui-listpicker-rule"> </div>')[0],b.rule.style.height=b.itemHeight+"px",b.rule.style.marginTop=-(b.itemHeight/2)+"px",b.box.appendChild(b.rule),b.middle=b.boxInner.offsetHeight/2,b.options.enabled3d&&b.box.classList.add("three-dimensional")},_handleShim:function(){var b=this;b.options.enabledH5?(b.options.fiexdDur*=2,b._scrollerApi=a(b.boxInner).scroll(),b.setScrollTop=function(a,c,d){b._scrollerApi.scrollTo(0,-a,c)},b.getScrollTop=function(){var a=this;return a._scrollerApi.lastY>0?0:Math.abs(a._scrollerApi.lastY)}):(b.boxInner.addEventListener("scroll",function(c){b.disabledScroll||(b.isScrolling=!0,b.scrollTimer&&clearTimeout(b.scrollTimer),b.scrollTimer=setTimeout(function(){b.isScrolling=!1,b.isTouchDown&&a.os.ios||a.trigger(b.boxInner,"scrollend")},100))},!1),b.aniScrollTop=function(a,c,d){b.disabledScroll=!0;var e=c>0?c/10:1,f=(a-b.boxInner.scrollTop)/e;b._lastScrollTop=b.boxInner.scrollTop,b._aniScrollTop(a,0,e,f,d)},b._aniScrollTop=function(a,c,d,e,f){b.boxInner.scrollTop=b._lastScrollTop+e*c,d>c?setTimeout(function(){b._aniScrollTop(a,++c,d,e)},10):(b.disabledScroll=!1,f&&f())},b.setScrollTop=function(a,c,d){b.aniScrollTop(a,c)},b.getScrollTop=function(){var a=this;return a.boxInner.scrollTop},a.os.ios&&(b.boxInner.addEventListener("touchstart",function(a){var b=this;b.isTouchDown=!0},!1),b.boxInner.addEventListener("touchend",function(c){b.isTouchDown=!1,b.isScrolling||setTimeout(function(){a.trigger(b.boxInner,"scrollend")},0)},!1)))},_handleHighlight:function(){var b=this,c=b.getScrollTop(),d=parseInt((c/b.itemHeight).toFixed(0)),e=[].slice.call(a("li",b.list));e.forEach(function(c){var f=e.indexOf(c);if(f==d?(c.classList.add(a.className("listpicker-item-selected")),c.classList.remove(a.className("listpicker-item-before")),c.classList.remove(a.className("listpicker-item-after"))):(c.classList.add(a.className("listpicker-item-"+(d>f?"before":"after"))),c.classList.remove(a.className("listpicker-item-selected"))),b.options.enabled3d){var g=b.middle-(c.offsetTop-b.getScrollTop()+b.itemHeight/2)+1,h=g/b.itemHeight,i=18*h;i>180&&(i=180),-180>i&&(i=-180),c.style.webkitTransform="rotateX("+i+"deg)"}})},_triggerChange:function(){var b=this;a.trigger(b.box,"change",{index:b.getSelectedIndex(),value:b.getSelectedValue(),text:b.getSelectedText(),item:b.getSelectedItem(),element:b.getSelectedElement()})},_scrollEndHandle:function(){var a=this,b=a.getScrollTop(),c=(b/a.itemHeight).toFixed(0);a.disabledScrollEnd=!0,a.setSelectedIndex(c),a._triggerChange(),a._handleHighlight(),setTimeout(function(){a.disabledScrollEnd=!1,a._handleHighlight()},a.options.fiexdDur)},_bindEvent:function(){var b=this;b.boxInner.addEventListener("scroll",function(a){b._handleHighlight(a)},!1),b.disabledScrollEnd=!1,b.boxInner.addEventListener("scrollend",function(a){b.disabledScrollEnd||(b.disabledScrollEnd=!0,b._scrollEndHandle())},!1),a(b.boxInner).on("tap","li",function(c){var d=this,e=[].slice.call(a("li",b.list));for(var f in e){var g=e[f];if(g==d)return void b.setSelectedIndex(f)}})},getSelectedIndex:function(){var a=this;return(a.getScrollTop()/a.itemHeight).toFixed(0)},setSelectedIndex:function(a,b){var c=this;a=a||0,c.setScrollTop(c.itemHeight*a,b?0:c.options.fiexdDur)},getSelectedElement:function(){var b=this,c=b.getSelectedIndex();return a("li",b.list)[c]},getSelectedItem:function(){var a=this,b=a.getSelectedElement();if(!b)return null;var c=b.getAttribute("data-item");return c?JSON.parse(c):{text:b.innerText,value:b.getAttribute("data-value")}},setItems:function(a){var b=this,c=[];for(index in a){var d=a[index]||{text:"null",value:"null"+index},e=JSON.stringify(d);c.push("<li data-value='"+d.value+"' data-item='"+e+"'>"+d.text+"</li>")}b.list.innerHTML=c.join(""),b._scrollerApi&&b._scrollerApi.refresh&&b._scrollerApi.refresh(),b._handleHighlight(),b._triggerChange()},getItems:function(){var b=this,c=[],d=a("li",b.list);for(index in d){var e=d[index],f=e.getAttribute("data-item");c.push(f?JSON.parse(f):{text:e.innerText,value:e.getAttribute("data-value")})}return c},getSelectedValue:function(){var a=this,b=a.getSelectedItem();return b?b.value:null},getSelectedText:function(){var a=this,b=a.getSelectedItem();return b?b.text:null},setSelectedValue:function(b,c){var d=this,e=a("li",d.list);for(index in e){var f=e[index];if(f&&f.getAttribute&&f.getAttribute("data-value")==b)return void d.setSelectedIndex(index,c)}},_applyToBox:function(){var a=this,b=["getSelectedIndex","setSelectedIndex","getSelectedElement","getSelectedItem","setItems","getItems","getSelectedValue","getSelectedText","setSelectedValue"],c=function(b){"function"==typeof a[b]?a.box[b]=function(){return a[b].apply(a,arguments)}:a.box[b]=a[b]};for(var d in b){var e=b[d];c(e)}}});a.fn.listpicker=function(a){return this.each(function(b,d){if(a)new c(d,a);else{var e=d.getAttribute("data-listpicker-options"),f=e?JSON.parse(e):{};f.enabledH5=d.getAttribute("data-listpicker-enabledh5")||f.enabledH5,f.enabled3d=d.getAttribute("data-listpicker-enabled3d")||f.enabled3d,f.fixedDur=d.getAttribute("data-listpicker-fixddur")||f.fixedDur,new c(d,f)}}),this},a.ready(function(){a(".mui-listpicker").listpicker()})}(mui),function(a,b){var c='<div class="mui-poppicker">		<div class="mui-poppicker-header">			<button class="mui-btn mui-poppicker-btn-cancel">取消</button>			<button class="mui-btn mui-btn-blue mui-poppicker-btn-ok">确定</button>			<div class="mui-poppicker-clear"></div>		</div>		<div class="mui-poppicker-body">		</div>	</div>',d='<div class="mui-listpicker">		<div class="mui-listpicker-inner">			<ul>			</ul>		</div>	</div>';a.PopPicker=a.Class.extend({init:function(d){var e=this;e.options=d||{},e.options.buttons=e.options.buttons||["取消","确定"],e.panel=a.dom(c)[0],b.body.appendChild(e.panel),e.ok=e.panel.querySelector(".mui-poppicker-btn-ok"),e.cancel=e.panel.querySelector(".mui-poppicker-btn-cancel"),e.body=e.panel.querySelector(".mui-poppicker-body"),e.mask=a.createMask(),e.cancel.innerText=e.options.buttons[0],e.ok.innerText=e.options.buttons[1],e.cancel.addEventListener("tap",function(a){e.hide()},!1),e.ok.addEventListener("tap",function(a){if(e.callback){var b=e.callback(e.getSelectedItems());b!==!1&&e.hide()}},!1),e.mask[0].addEventListener("tap",function(){e.hide()},!1),e._createListPicker()},_createListPicker:function(){var b=this,c=b.options.layer||1,e=100/c+"%";b.pickers=[];for(var f=1;c>=f;f++){var g=a.dom(d)[0];g.style.width=e,b.body.appendChild(g),a(g).listpicker(),b.pickers.push(g),g.addEventListener("change",function(a){var b=this.nextSibling;if(b&&b.listpickerId){var c=a.detail||{},d=c.item||{};b.setItems(d.children)}},!1)}},setData:function(a){var b=this;a=a||[],b.pickers[0].setItems(a)},getSelectedItems:function(){var a=this,b=[];for(var c in a.pickers){var d=a.pickers[c];b.push(d.getSelectedItem())}return b},show:function(c){var d=this;d.callback=c,d.mask.show(),b.body.classList.add(a.className("poppicker-active-for-page")),d.panel.classList.add(a.className("active"))},hide:function(){var c=this;c.panel.classList.remove(a.className("active")),c.mask.close(),b.body.classList.remove(a.className("poppicker-active-for-page"))}})}(mui,document);